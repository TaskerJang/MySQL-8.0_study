## 1) **Transparent Page Compression (페이지 압축)에 대한 설명**

1. **페이지 압축(TPC) 개요**
    - **용어 설명:** Transparent Page Compression(TPC)은 데이터베이스에서 사용되는 기술로, 페이지 수준에서 데이터를 압축하는 기능을 의미합니다.
    - **투명한 처리:** 사용자 또는 응용 프로그램에서 추가적인 설정이나 변경 없이 데이터베이스 시스템에서 자동으로 페이지 압축을 처리하는 방식입니다.

2. **주요 특징 및 동작 원리**
    - **데이터 압축:** TPC는 테이블에 저장되는 데이터를 페이지 단위로 압축합니다. 압축된 페이지는 디스크에 저장되고, 필요할 때마다 압축 해제하여 사용됩니다.
    - **성능과 공간 효율성:** 주로 저장 공간의 효율성을 높이고 디스크 I/O를 줄이는 목적으로 사용됩니다. 압축된 데이터는 디스크에 적은 양의 공간을 차지하며, 디스크에서 읽거나 쓸 때 더 적은 양의 데이터를 처리할 수 있습니다.
    - **투명한 처리:** 사용자는 페이지 압축이 적용되었는지 신경 쓰지 않고, 데이터베이스 시스템이 자동으로 페이지를 압축하고 압축 해제합니다.

3. **적용 및 사용 사례**
    - **데이터베이스 시스템에 따른 지원:** 페이지 압축은 데이터베이스 시스템에 따라 다르게 구현될 수 있습니다. 일부 데이터베이스 시스템에서는 투명한 페이지 압축을 지원하며, 설정이나 관리 없이 자동으로 압축을 수행합니다.
    - **효과적인 사용 사례:** 페이지 압축은 특히 대량의 데이터를 다루는 데이터베이스 시스템에서 저장 공간의 효율성을 향상시키고 디스크 I/O 비용을 감소시킬 때 효과적입니다.

4. **주의사항 및 한계**
    - **CPU 부하:** 압축과 압축 해제는 CPU를 사용하므로, 시스템에서 CPU 부하에 대한 고려가 필요합니다.
    - **읽기/쓰기 성능:** 압축된 페이지를 읽거나 쓰는 데에는 추가적인 연산이 필요하므로, 압축을 적용할 때의 성능 영향을 고려해야 합니다.
    - **데이터 변경 빈도:** 자주 변경되는 데이터에 대해서는 페이지 압축을 적용하지 않는 것이 좋을 수 있습니다.

5. **결론**
    - **페이지 압축의 활용:** Transparent Page Compression(TPC)은 저장 공간 효율성을 높이고 디스크 I/O를 줄이는 데에 활용되는 데이터베이스의 기능입니다. 사용 사례 및 성능 영향을 고려하여 적절한 상황에서 활용될 수 있습니다.

## 2) 테이블 압축에 대한 설명

1. **테이블 압축 기능**
    - **운영체제나 하드웨어 제약 없이 사용 가능:** 테이블 압축은 MySQL InnoDB 스토리지 엔진에서 제공하는 기능으로, 특별한 운영체제나 하드웨어 제약 없이 사용할 수 있습니다.
    - **전제조건:** 테이블 압축을 사용하기 위해서는 테이블이 별도의 테이블 스페이스를 사용하도록 설정되어야 합니다. `innodb_file_per_table` 시스템 변수가 ON으로 설정된 상태에서 테이블이 생성되어야 합니다.

2. **장점과 단점**
    - **장점:**
        - **운영체제 및 하드웨어 독립성:** 테이블 압축은 특별한 운영체제나 하드웨어 제약 없이 사용 가능하며, 데이터 압축을 통해 저장 공간을 절약할 수 있습니다.

    - **단점:**
        - **버퍼풀 공간 활용률 감소:** 테이블 압축을 사용하면 압축된 데이터가 버퍼풀에 올라가더라도 실제 압축 전 데이터 크기만큼의 공간을 차지하므로, 버퍼풀 공간 활용률이 낮아집니다.

        - **쿼리 처리 성능 저하:** 압축된 데이터를 읽고 쓰는 과정에서 압축 및 압축 해제 연산이 필요하므로, 쿼리 처리 성능이 상대적으로 낮을 수 있습니다.

        - **빈번한 데이터 변경 시 압축률 저하:** 테이블 압축은 데이터의 변경이 빈번하게 발생하는 경우 압축률이 저하될 수 있습니다.

3. **사용 시 주의사항**
    - **적절한 상황에서 사용:** 테이블 압축은 저장 공간을 절약하기 위한 목적으로 사용되므로, 테이블의 특성과 데이터 변경 패턴을 고려하여 적절한 상황에서 사용해야 합니다.

    - **버퍼풀 크기 조정:** 테이블 압축을 사용할 경우 버퍼풀 크기를 조정하여 성능 향상을 고려해야 합니다.

4. **결론**
    - **테이블 압축의 활용:** 테이블 압축은 데이터의 저장 공간을 절약하기 위한 기능으로, 적절한 상황에서 사용될 때 효과적입니다. 그러나 단점인 쿼리 처리 성능 저하와 압축률 감소를 고려하여 사용해야 합니다.

## 3) 테이블 압축에서의 중요한 요소: KEY_BLOCK_SIZE 및 목표 크기 설정

1. **KEY_BLOCK_SIZE와 목표 크기 설정의 중요성**
    - **KEY_BLOCK_SIZE:** InnoDB에서 테이블 압축을 위한 `KEY_BLOCK_SIZE`는 페이지에 압축된 데이터를 저장하는 데 사용되는 크기를 나타냅니다.
    - **목표 크기 설정:** 목표 크기는 원본 데이터 페이지의 압축 결과가 `KEY_BLOCK_SIZE`보다 작거나 같을 때까지 페이지를 스플릿하는 기준이 됩니다.

2. **반복적인 페이지 스플릿**
    - **압축 결과가 목표 크기보다 작지 않을 때:** 테이블 압축은 페이지의 압축 결과가 목표 크기보다 작거나 같을 때까지 반복해서 페이지를 스플릿합니다. 이는 압축률을 개선하고 목표 크기에 가깝게 데이터를 압축하는 데 도움이 됩니다.

3. **올바른 목표 크기 설정의 중요성**
    - **서버 처리 성능 영향:** 목표 크기가 너무 작거나 크게 설정되면 서버의 처리 성능이 급격히 떨어질 수 있습니다.
    - **적절한 압축률 유지:** 목표 크기를 올바르게 설정하면 압축된 데이터를 효과적으로 유지하면서도 성능 손실을 최소화할 수 있습니다.

4. **서버 설정 및 성능 튜닝**
    - **테스트 및 모니터링:** 목표 크기 설정은 테스트와 모니터링을 통해 조정되어야 합니다. 특히 시스템의 특성과 작업 패턴을 고려하여 목표 크기를 조정하는 것이 중요합니다.
    - **KEY_BLOCK_SIZE 조정:** 또한 `KEY_BLOCK_SIZE` 역시 테이블의 압축 효과에 영향을 미치므로 적절한 설정이 필요합니다.

5. **결론**
    - **목표 크기와 성능 균형:** 테이블 압축에서 가장 중요한 것은 목표 크기의 설정입니다. 적절한 목표 크기를 설정하여 압축 결과를 효과적으로 관리하면서도 서버의 처리 성능을 최적화하는 것이 핵심입니다. 설정은 테스트와 모니터링을 통해 조정되어야 합니다.

## 4) 압축 실패율과 테이블 활용의 고려

1. **압축 실패율이 낮아도**
    - **의미 없는 압축 실패율:** 압축 실패율이 낮다고 해서 항상 압축을 사용해야 하는 것은 아닙니다. 압축은 데이터의 특성에 따라 효과적이거나 그렇지 않을 수 있습니다.
    - **데이터 조회 및 변경 빈도:** 압축 실패율이 낮더라도, 테이블의 데이터가 매우 빈번하게 조회되고 변경된다면 압축의 효과를 고려하지 않는 것이 더 나을 수 있습니다.

2. **압축 사용의 고려 사항**
    - **데이터 조회 빈도가 높은 경우:** 테이블의 데이터가 매우 빈번하게 조회되는 상황에서는 압축을 사용하면 조회 성능이 저하될 수 있습니다.
    - **데이터 변경 빈도가 높은 경우:** 압축은 데이터의 변경이 빈번한 경우에는 압축률이 저하되므로, 데이터 변경 빈도가 높은 테이블에 대해서는 압축을 사용하지 않는 것이 좋을 수 있습니다.

3. **성능 향상을 위한 고려**
    - **압축 효과 측정:** 압축을 사용할 때와 사용하지 않을 때의 성능을 측정하여 효과를 확인하는 것이 중요합니다.
    - **시스템의 특성 고려:** 시스템의 특성과 작업 패턴을 고려하여 압축의 여부를 결정해야 합니다.

4. **압축 적용 시 주의 사항**
    - **압축 실패율 모니터링:** 압축을 적용한 경우에도 주기적으로 압축 실패율을 모니터링하여 시스템의 변화에 따른 적절한 대응이 필요합니다.
    - **적절한 설정:** 압축 실패율과 성능 간의 균형을 유지하기 위해 압축 관련 설정을 적절하게 조정해야 합니다.

5. **결론**
    - **압축 사용의 적절성 판단:** 압축을 사용할지 여부는 압축 실패율 뿐만 아니라 데이터의 조회 및 변경 빈도, 시스템의 특성 등을 종합적으로 고려하여 판단해야 합니다. 최적의 성능을 위해서는 특정 상황에 맞게 설정을 조정하는 것이 중요합니다.

## 5) 테이블 압축 관련 설정

1. `innodb_cmp_per_index_enabled`는 InnoDB 스토리지 엔진에서 제공하는 테이블 압축과 관련된 설정 중 하나입니다. 이 설정은 테이블 압축이 사용된 테이블의 모든 인덱스 별로 압축 성공 및 압축 실행 횟수를 수집하도록 하는 기능을 제어합니다.

**설정 내용:**

 **`innodb_cmp_per_index_enabled` 설정:**
    - **설명:** 이 설정은 각 인덱스에 대한 테이블 압축 관련 정보를 수집하는 기능을 활성화 또는 비활성화합니다.
    - **값:**
        - `ON`: 테이블의 각 인덱스에 대한 압축 성공 및 압축 실행 횟수를 수집합니다.
        - `OFF`: 압축 관련 정보를 수집하지 않습니다.

**사용 예시:**

```sql
-- innodb_cmp_per_index_enabled 활성화
SET GLOBAL innodb_cmp_per_index_enabled = ON;
```

**주의사항 및 고려 사항:**

 **통계 수집의 Overhead:** 이 설정을 활성화하면 압축 관련 통계를 수집하기 위한 추가적인 작업이 수행되므로 일부 성능 손실이 발생할 수 있습니다.

 **모니터링 및 튜닝:** 성능을 모니터링하면서 이 설정을 사용하여 압축 성공 및 실행 횟수에 대한 통계를 적절히 분석하여 성능 튜닝에 활용할 수 있습니다.

이 설정을 사용하여 압축에 대한 성능 및 통계 정보를 수집하고자 하는 경우, 적절한 상황에서 활성화하고 모니터링을 통해 성능 영향을 확인하는 것이 중요합니다.

2. **`innodb_compression_level`:**
    - **설명:** 압축 레벨을 지정하는 변수로, 0에서 9까지의 값을 선택할 수 있습니다. 값이 작을수록 압축 속도는 빨라지지만 저장 공간은 커질 수 있습니다.

3. **`innodb_compression_failure_threshold_pct` 및 `innodb_compression_pad_pct_max`:**
    - **설명:** 테이블 단위로 압축 실패율이 `innodb_compression_failure_threshold_pct`보다 커지면, 압축을 실행하기 전 원본 데이터 페이지의 끝에 일정 크기의 빈 공간을 추가하는데, 이 공간을 패딩이라고 합니다. `innodb_compression_pad_pct_max`는 이때의 최대 패딩 크기를 제어합니다.

4. **`innodb_log_compressed_pages`:**
    - **설명:** MySQL 서버가 비정상적으로 종료되어 다시 시작될 때, 압축 알고리즘의 버전 차이가 있더라도 복구 과정이 실패하지 않도록 InnoDB 스토리지 엔진은 압축된 데이터 페이지를 리두로그에 기록합니다.
    - **값:**
        - `ON`: 압축된 데이터 페이지를 리두로그에 기록합니다.
        - `OFF`: 리두로그에 압축된 데이터 페이지를 기록하지 않습니다.

**주의사항:**
- `innodb_compression_level`은 압축 속도와 저장 공간 사이의 균형을 조절할 수 있는 중요한 설정입니다. 적절한 값을 선택해야 합니다.
- `innodb_log_compressed_pages`는 리두로그 용량 및 성능에 영향을 미칠 수 있습니다. 특히 압축 적용 후 리두 로그 용량이 급격히 증가하거나 버퍼 풀에서 더티 페이지가 많이 기록되는 경우에 주의가 필요합니다.